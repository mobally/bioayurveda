'use strict';define(['jquery','ko','uiComponent','MSP_TwoFactorAuth/js/error','MSP_TwoFactorAuth/js/registry'],function($,ko,Component,error,registry){return Component.extend({currentStep:ko.observable('register'),waitText:ko.observable(''),verifyCode:ko.observable(''),defaults:{template:'MSP_TwoFactorAuth/google/auth'},trustThisDevice:registry.trustThisDevice,qrCodeUrl:'',postUrl:'',successUrl:'',secretCode:'',getQrCodeUrl:function(){return this.qrCodeUrl;},getPostUrl:function(){return this.postUrl;},getSecretCode:function(){return this.secretCode;},nextStep:function(){this.currentStep('login');self.location.href=this.successUrl;},doVerify:function(){var me=this;this.waitText('Please wait...');$.post(this.getPostUrl(),{'tfa_code':this.verifyCode(),'tfa_trust_device':me.trustThisDevice()?1:0}).done(function(res){if(res.success){me.nextStep();}else{error.display(res.message);me.verifyCode('');}
me.waitText('');}).fail(function(){error.display('There was an internal error trying to verify your code');me.waitText('');});}});});