'use strict';define(['jquery','ko','uiComponent','MSP_TwoFactorAuth/js/error','MSP_TwoFactorAuth/js/u2fkey/api'],function($,ko,Component,error){return Component.extend({currentStep:ko.observable('register'),defaults:{template:'MSP_TwoFactorAuth/u2fkey/configure'},postUrl:'',successUrl:'',touchImageUrl:'',registerData:{},onAfterRender:function(){this.waitForTouch();},getTouchImageUrl:function(){return this.touchImageUrl;},getPostUrl:function(){return this.postUrl;},getSuccessUrl:function(){return this.successUrl;},waitForTouch:function(){var requestData=this.registerData[0],signs=this.registerData[1],me=this;u2f.register([requestData],signs,function(registerResponse){$.post(me.getPostUrl(),{'request':requestData,'response':registerResponse}).done(function(res){if(res.success){me.currentStep('login');self.location.href=me.getSuccessUrl();}else{me.waitForTouch();}}).fail(function(){error.display('Unable to register your device');});},120);}});});